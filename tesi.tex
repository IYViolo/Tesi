
\documentclass[12pt]{article}
\usepackage[english]{babel}
\usepackage{amsfonts}
\usepackage{extsizes}
\usepackage[utf8]{inputenc}
\usepackage{amsthm}
\usepackage{ mathrsfs }
\usepackage{ amsmath }
\usepackage{ amssymb }
\usepackage{enumerate}
\usepackage{cite}
\usepackage{bbm}

\theoremstyle{definition}
\newtheorem{definition}{Definition}

\newtheorem{remark}{Remark}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}

\DeclareMathOperator\supp{supp}
\DeclareMathOperator\Lip{Lip}
\DeclareMathOperator\rr{\mathbb{R}}
\DeclareMathOperator\nn{\mathbb{N}}
\DeclareMathOperator\wt{\widetilde}
\newcommand\addtag{\refstepcounter{equation}\tag{\theequation}}

\begin{document}
\section{Hestenes Operator}

\iffalse
First we consider the single variable case.

\begin{remark}
Let $\Omega \subset \mathbb{R}$. Saying $f\in W^{l,p}(\Omega)$ is equivalent to say that $f=\widetilde{f}$ a.e. for a function $\widetilde{f}$ such that its derivatives $\widetilde{f}^{(s)}$ are continuous for $s=1,..,l-1$ and $\widetilde{f}^{(l-1)}$ is locally absolutely continuous. Moreover if $\Omega=(a,b)$ then the limits $\widetilde{f}^{(s)}(a+)$, $\widetilde{f}^{(s)}(b-)$ exists for every $s=0,...,l-1$.
\end{remark}

\begin{lemma}
Let $-\infty<a<b<c<\infty$. If a function $f$ defined on $[a,c]$  is absolutely continuous on $[a,b]$ and absolutely continuous on $[b,c]$, then it is also absolutely continuous on $[a,c]$.
\end{lemma}

\begin{lemma}
Let $l\in  \mathbb{N}, 1\le p \le \infty, -\infty\le a <b <c \le \infty$. Given $f \in W^{l,p}(a,b)$ and $g \in W^{l,p}(b,c)$ such that
\[ f^{(s)}(a-)=g^{(s)}(b+),  \ \ \  s=0,...,l-1 \]
then the function

\[   h(x)=\begin{cases}
		f(x) & x\in(a,b) \\
		g(x) & x \in (b,c) 
	    \end{cases}
\]
belongs to $W^{l,p}(a,c)$.
\end{lemma}



\begin{lemma}
Let $l \in \mathbb{N}$, $1\le p\le \infty.$ There exists a bounded extension operator 
\[ T : W^{l,p}(-\infty,0) \rightarrow W^{l,p}(\mathbb{R}). \]
\end{lemma}
\begin{proof}
Let's define 
\[   Tf(x) = \begin{cases}
				f(x) &  x<0 \\
				\sum_{k=1}^l \alpha_kf(-\beta_k x)  &   x>0 \\
	        \end{cases}
\]
where $\alpha_k,\beta_k$ are real numbers that satisfy $\beta_k>0$ and
\begin{equation}\label{alfabeta}
 \sum_{k=1}^l \alpha_k (-\beta_k)^s=1  
\end{equation}
for every $s=0,...,l-1$.  Notice that given $\beta_1,...,\beta_l>0$  pairwise distinct, we can always find $\alpha_1,...,\alpha_l$ that satisfy the condition by solving a Vandermonde square system of linear equations. Clearly $Tf\in W^{l,p}(0,\infty)$, moreover equation \eqref{alfabeta} assures that
\[ Tf^{(s)}(0+)=f^{(s)}(0-)\]
hence by Lemma 2  $Tf \in W^{l,p}(\mathbb{R})$. We can compute
\begin{align*}
 \|Tf\|_{W^{l,p}(0,\infty)} &\le \sum_{k=1}^l |\alpha_k|  \left( \int_0^\infty  |f(-\beta_k x)|^p dx\right ) ^\frac{1}{p} + \sum_{k=1}^l |\alpha_k| \beta_k^{l} \left( \int_0^\infty  |f^{(l)}_w(-\beta_k x)|^p dx\right ) ^\frac{1}{p} \\
  &=\sum_{k=1}^l |\alpha_k| \beta_k^{-\frac{1}{p}} \left( \int_0^\infty  |f(-y)|^p dx\right ) ^\frac{1}{p} +\sum_{k=1}^l |\alpha_k| \beta_k^{l-\frac{1}{p}} \left( \int_0^\infty  |f^{(l)}_w(-y)|^p dx\right ) ^\frac{1}{p} \\
  &\le C\|f\|_{W^{l,p}(-\infty,0)} 
\end{align*}
where $C$ is a constant depending on $\beta_k,\alpha_k,l$. Now the required statement follows observing that $\|Tf\|_{W^{l,p}(\mathbb{R})}=\|Tf\|_{W^{l,p}(0,\infty)}+\|f\|_{W^{l,p}(-\infty,0)} $.
\end{proof}

\fi 

\subsection{Construction}
We construct the Hestenes operator for domains  $\Omega \subset \mathbb{R}^n$ with $C^m$ boundary mainly following paragraphs 6.2,6.3 of \cite{burenkov}. First we consider a simple case where $\Omega$ is a $C^m$ half strip.
\begin{lemma}\label{hestenes1}
Let $l,n,m \in \mathbb{N}, m\ge l, 1\le p \le \infty$ and $W = \prod\limits_{i=1}^{n-1}]a_i,b_i[$ be an open cuboid of $\mathbb{R}^{n-1}$. Moreover define
\[ S=W \times \mathbb{R} \]
\[\Omega =\{ (\overline x,x_n) | \overline x\in W, x_n<\phi(\overline x)  \} \]
where $\phi \in C^m(\overline W)$,$m\ge l$, and $\| D^{\alpha}\phi \|\le M <\infty $ for every $1\le|\alpha|\le l$. Then there exists a bounded extension operator $T$ from $W^{l,p}(\Omega)$ to $W^{l,p}(S).$
\end{lemma}





To prove Lemma $\ref{hestenes1}$ we prove first the case $\phi \equiv 0$ in the following result, that is a generalization of Lemma 9.2 in \cite{brezis}.

\begin{lemma}\label{hestenes2}
Let $l,n \in \mathbb{N}, 1\le p \le \infty$ and $W = \prod\limits_{i=1}^{n-1}]a_i,b_i[$ be an open cuboid of $\mathbb{R}^{n-1}$. There exists a bounded extension operator
\[ T: W^{l,p}(S^-) \rightarrow W^{l,p}(S)\]
where 
\[ S=W \times \mathbb{R} \]
\[ S^-=W \times \mathbb{R}^-.\]
\end{lemma}
\begin{proof}
Let $f \in W^{l,p}(S^-)$. We define
\[ Tf(\overline x,x_n) = \begin{cases}
		f(x), & \text {if }x_n<0, \\
		\sum_{k=1}^l \alpha_k f(\overline x,-\beta_k x_n),  &\text {if } x_n>0, 
		\end{cases}
\]
where $\alpha_k,\beta_k$ are real numbers that satisfy $\beta_k>0$ and
\begin{equation}\label{alfabeta}
 \sum_{k=1}^l \alpha_k (-\beta_k)^s=1  
\end{equation}
for every $s=0,...,l-1$.  Notice that given $\beta_1,...,\beta_l>0$  pairwise distinct, we can always find $\alpha_1,...,\alpha_l$ that satisfy the condition by solving a Vandermonde square system of linear equations. First we prove that $Tf \in W^{l,p}(S)$. We take any $\phi \in C^\infty_c(S)$ and consider the integral 
\[ \int_S Tf(x)D^\alpha\phi(x)dx= \int_{S^+} Tf(x)D^\alpha\phi(x)dx+ \int_{S^-} Tf(x)D^\alpha\phi(x)dx\]
where $S^+=\{(\overline x,x_n) \ | \  \overline x \in W, x_n>0 \}$ and $\alpha \in \mathbb{N}^n_0, 1\le|\alpha|\le l$. Let's write $\alpha=(\overline \alpha,\alpha_n)$, with $\overline \alpha \in \mathbb{N}^{n-1}_0$ and $\alpha_n \in  \mathbb{N}_0$.  By changing variables in the integrals we get 
\begin{align*}
 \int_S Tf(x)D^\alpha\phi(x)dx &= \int_{S^+}\sum_{k=1}^l \alpha_k f(\overline x,-\beta_k x_n)  D^\alpha\phi(x)dx+ \int_{S^-} f(x)D^\alpha\phi(x) dx\\
				   &= \int_{S^-} f(\overline y,y_n) D^\alpha \psi(\overline y, y_n) dy \tag{*}
\end{align*}
where $\psi(\overline x,x_n)= \sum_{k=1}^l -\alpha_k (-\beta_k)^{\alpha_n-1}\phi \left( \overline x,-x_n/\beta_k\right)+\phi(\overline x,x_n) $.Note that $\psi$ belongs to $\in C^\infty(S^-)$ but does not have compact support in $S^-$. To bypass this problem we use an auxiliary function $\nu \in C^\infty(\mathbb{R})$ that satisfies 
\[ \begin{cases}
	\nu(x)=0, & \text{if } x>-1/2, \\
	\nu(x)=1, & \text{if }x<-1,
\end{cases} 
\]
and we define the functions $\nu_k(t)=\nu(kt)$ for $k \in \mathbb{N}$. It's clear that $\psi(x) \nu_k(x_n) \in C^\infty_c(S^-)$, hence we can integrate by parts
\begin{equation}\label{parts}
\int_{S^-}  f(x)D^{\alpha}(\psi(x) \nu_k(x_n)) dx = (-1)^{|\alpha|}\int_{S^-} D^\alpha_w f(x)\psi(x) \nu_k(x_n) dx  
\end{equation}
By the Leibniz rule 
\begin{align*}
D^{\alpha}(\psi(x) \nu_k(x_n)) &=\frac{\partial^{\alpha_n}}{\partial x_n^{\alpha_n}} D^{\overline \alpha}(\psi(x) \nu_k(x_n)) \\
				        &= \nu(kx_n)D^{\alpha}\psi(x)+\sum_{i=1}^{\alpha_n}  {{\alpha_n}  \choose {i} }  k^i \nu^{(i)}(kx_n)\frac{\partial^{\alpha_n-i}}{\partial x_n^{\alpha_n-i}} D^{\overline \alpha}\psi(x).
\end{align*}
By the Dominated Convergence Theorem
\[ \int_{S^-} f(x) \nu(kx_n)D^{\alpha}\psi(x)dx  \rightarrow \int_{S^-} f(x) D^{\alpha}\psi(x)dx \text{    as } k\rightarrow \infty,\]
because $f \in L^1(S^- \cap \supp \psi)$ since $\supp \psi$ is bounded.
Next, we claim that for every $i=1,..,\alpha_n$
\begin{equation}\label{lim}
\int_{S^-}  f(x) k^i \nu^{(i)}(kx_n)\frac{\partial^{\alpha_n-i}}{\partial x_n^{\alpha_n-i}} D^{\overline \alpha}\psi(x)dx  \rightarrow 0 
\end{equation}
as $k \rightarrow \infty$. To prove this first we notice that since  $\alpha_k,\beta_k$ satisfies $\eqref{alfabeta}$ we have that 
\[   \frac{\partial^j}{\partial x_n^j} D^{\overline \alpha}\psi(\overline x, 0)=0 \text{  ;  }j=0,...,\alpha_n-1,\]
hence by Taylor formula 
\[  \left| \frac{\partial^{\alpha_n - i}}{\partial x_n^{\alpha_n - i}} D^{\overline \alpha}\psi(\overline x, x_n) \right|  \le \frac{C|x_n|^i}{i!},\]
for all $i=1,...,\alpha_n$, where $C= \sup_{x \in   S^-} |D^{\alpha} \psi(x)|$. Therefore we get the following estimate
\begin{align*}
   	\int_{S^-}  \left|  f(x) k^i \nu^{(i)}(kx_n)\frac{\partial^{\alpha_n-i}}{\partial x_n^{\alpha_n-i}} D^{\overline \alpha}\psi(x)     \right |  dx  &\le 
	 \frac{\widetilde CC}{i!} \int_{ \{ x \in S^-\cap \supp f \ , \ -1/k< x_n<0 \} }   |f(x)| k^i |x_n|^i  dx  \\
	& \le \frac{\widetilde CC}{i!}   \int_{ \{ x \in S^-\cap \supp f \ ,\  -1< x_n<0 \} }   |f(x)| dx 
\end{align*}
where $\widetilde C = \sup_\mathbb{R} |\nu^{(i)}|$. The second inequality comes from the fact that $\nu^{(i)}(x)=0$ for $x<-1$ and $i\ge 1$. Hence we get $\eqref{lim}$ by Dominated Convergence Theorem. Passing to the limit in $\eqref{parts}$ we obtain
\[ \int_{S^-}  f(x)D^{\alpha}\psi(x) dx = (-1)^{|\alpha|}\int_{S^-} D^\alpha_wf(x)\psi(x)  dx.  \]
which, combined with (*), implies
\[ \int_S Tf(x)D^{\alpha}\phi(x)dx=  \int_{S^-}  f(x)D^{\alpha}\psi(x) dx = (-1)^{|\alpha|}\int_{S^-} D^\alpha_wf(x)\psi(x)  dx. \]
Finally going back to the original coordinates and using the definition of $\psi$ we get
\begin{align*}
& \int_S Tf(x)D^{\alpha}\phi(x)dx = (-1)^{|\alpha|} \int_{S^-}D^\alpha_w f(x) \left[\sum_{k=1}^l -\alpha_k (-\beta_k)^{\alpha_n-1}\phi \left( \overline x,-\frac{x_n}{\beta_k} \right)+\phi(\overline x,x_n)\right] dx=\\
					&= (-1)^{|\alpha|} \int_{S^+} \sum_{k=1}^l \alpha_k (-\beta_k)^{\alpha_n} D^\alpha_w f(\overline y,-\beta_k y_n)\phi(y)dy +(-1)^{|\alpha|} \int_{S^-} D^\alpha_w f(y)\phi(y) dy
\end{align*}
that implies that $D^\alpha_wTf$ exists and 
\[ D^\alpha_wTf(x)= \begin{cases}
			 D^\alpha_w f(x),	& \text{if } x \in S^-, \\
			\sum_{k=1}^l \alpha_k (-\beta_k)^{\alpha_n} D^\alpha_w f(\overline x,-\beta_k x_n)\phi(x), & \text{if }x \in S^+.
		\end{cases}
 \]
It remains to prove the boundedness of  T. It's immediate to verify that
\[ \| Tf \|_{L^p(S^+)}\le \sum_{i=1}^l |\alpha_k|\beta_k^{-1/p} \| f\|_{L^p(S^-)} \] 
and that we have similar bounds for the norm of the weak derivatives of $Tf$. Hence there exists a constant $C$ depending only on $\beta_k,\alpha_k,l$ such that $\| Tf\|_{W^{l,p}(S^+)}\le C \| f\|_{W^{l,p}(S^-)} $. Observing that $\| Tf\|^p_{W^{l,p}(S)}=\| Tf\|^p_{W^{l,p}(S^+)}+\|f\|^p_{W^{l,p}(S^-)}$ the proof is concluded.
\end{proof}


\begin{lemma}\label{composition}
Let $l \in \nn$ and $\Omega$ be a domain in $\rr^n$. Suppose that $f \in L^1_{loc}(\Omega)$ admits all the weak derivatives up to order $l$ and that $g:\Omega'\rightarrow \Omega$ is a diffeomorphism of class $C^l$ with bounded derivatives $|D^\alpha g_k|\le M$ for all $1 \le |\alpha| \le l$. Then $f\circ g$ admits weak derivative up to order $l$. Moreover for every $1\le |\alpha|\le l$ we have to following bounds
\[ |D^\alpha (f\circ g)(x)|\le C \sum_{1\le|\beta|\le |\alpha|} |D^\beta f(g(x))|\]
where $C$ depends only on $M$ and $l$.
\end{lemma}
\begin{proof}
We prove the statement by induction on $l$. For $l=1$ we know that exists a sequence of functions $\{f_k\}_k  \in C^\infty(\Omega)$ such that
\[ f_k \rightarrow f \qquad \text{in } L^1_{loc}(\Omega) \]
\[ \frac{\partial f_k }{\partial x_i}\rightarrow \frac{\partial f }{\partial x_i} \qquad \text{in } L^1_{loc}(\Omega).\]
Take $\phi \in C^\infty_c(\Omega')$ and integrate by parts
\[\int_{\Omega'} f_k(g(x))\frac{\partial \phi }{\partial x_i}(x)dx = - \int_{\Omega'} \left(\sum_{j=1}^n \frac{\partial f_k }{\partial x_j}(g(x))\frac{\partial g_j }{\partial x_i}(x)\right)\phi(x)dx.\]
Since $\phi(g^{-1}) \in C^l_c(\Omega)$ and the derivatives of $g$ and $g^{-1}$ are bounded, we can pass to the limit in the above equation
\[\int_{\Omega'} f(g(x))\frac{\partial \phi }{\partial x_i}(x)dx = - \int_{\Omega'} \left(\sum_{j=1}^n \frac{\partial f }{\partial x_j}(g(x))\frac{\partial g_j }{\partial x_i}(x)\right)\phi(x)dx.\]
Hence the case $l=1$ is proved. Now suppose that the statement is true for $l$. We prove the case $l+1$, so we suppose that $f$ admits weak derivatives up to order $l+1$ and that $g$ is of class $C^{l+1}$. From the case $l=1$ we know that $\frac{\partial (f \circ g) }{\partial x_i}$ exists and that
\[ \frac{\partial (f \circ g) }{\partial x_i}= \sum_{j=1}^n (\frac{\partial f }{\partial x_j} \circ g)\frac{\partial g_j }{\partial x_i}\] 
Since $\frac{\partial f }{\partial x_j}$ admits weak derivatives up to order $l$, by induction hypothesis the functions $\frac{\partial f }{\partial x_j} \circ g$ admit weak derivatives up to order $l$. Moreover $\frac{\partial g_j }{\partial x_i}$ is of class $C^l$, thus by the Leibniz rule the functions $(\frac{\partial f }{\partial x_j} \circ g)\frac{\partial g_j }{\partial x_i}$ admits weak derivatives of order $l$. In conclusion $\frac{\partial (f \circ g) }{\partial x_i}$ admits derivatives up to order $l$ and this conclude the proof of the case $l+1$. 

To prove the bounds we notice that the weak derivatives $D^\alpha (f \circ g)$ can be computed using the chain rule for usual derivatives. Such formula can be found in \cite[formula B] {fraenkel}:
\[ D^{\alpha}_w(f(g))(x) = \sum_{1\le |\beta|\le|\alpha| }D^{\beta}_w(f(g(x)) Q_{\alpha,\beta}(g,x)\]
In this formula $Q_{\alpha,\beta}(g,x)$ are homogeneous polynomials of degree $|\beta|\le l$ in the derivatives of order less than $l$ of the components of $g$. Moreover the coefficients of these polynomials depend only on $\alpha,l,n$. Hence there exists a constant $C$ depending only on $l,n,M$ such that $|Q_{\alpha,\beta}(g,x)|\ \le C$ uniformly on $x$. This concludes the proof.
\end{proof}

\begin{proof}[Proof of Lemma $\ref{hestenes1}$ ]
Let $f \in W^{l,p}(\Omega).$  Consider the function $g$ from $S^-$ onto $\Omega$ defined by
\[  g(\overline x, x_n)= (\overline x , x_n+ \phi(\overline x))\]
for all $(\overline x, x_n) \in S^-$
and its inverse  $g^{-1}$
\[  g^{-1}(\overline x, x_n)= (\overline x , x_n- \phi(\overline x))\]
where $S^-=W \times \rr^-$. For all $f \in W^{l,p}(\Omega)$ we set
\begin{align*}
 Gf=f \circ g
\end{align*}
Since $g$ is a diffeomorphism between $S^-$ and $\Omega$ of class $C^m$, Lemma \ref{composition} guarantees that $Gf$ admits weak derivatives up to order $l$. We claim that $G$ defines a bounded operator from $W^{l,p}(\Omega)$ to $W^{l,p}(S^-)$, with bounded inverse. To prove this, first we compute the Jacobian matrix of $g^{-1}$

\[ Jg^{-1}(x)= \begin{bmatrix}
		1             &             0  &            \dots &            &0 \\
		0             & 1              &   \dots           &            & 0\\
		\vdots    &                 &  \ddots           &  & \vdots\\
		\vdots    &                 &           &\ddots    &\\
		-\frac{\partial \phi(\overline x)}{\partial x_1} &-\frac{\partial \phi(\overline x)}{\partial x_2}& \dots & \dots & 1 
	\end{bmatrix}
\]
from which $|\det(Jg^{-1}(x))| \equiv 1 $. Moreover, again by Lemma $\ref{composition}$, we have
\[ |D^{\alpha}_w(f(g))| \le C(l,M) \sum_{1\le |\beta|\le|\alpha| }|D^{\beta}_wf(g)|\]
where $C(l,M)$ depends only on $l$ and $M$, with $M= \sup_{1\le|\alpha|\le l} \| D^\alpha \phi \|$.
Next by the change of variable formula and Minkowski's inequality we get
\begin{align*}
 \left( \int_{S^-} |D^{\alpha}_w(f(g))(x)|^p dx \right)^{\frac{1}{p}} & \le \sum_{1\le |\beta|\le|\alpha| } C(l,M) \left( \int_{S^-} |D^{\beta}_wf(g(x))|^p  dx\right)^{\frac{1}{p}}  \\
										      &=  \sum_{1\le |\beta|\le|\alpha| } C(l,M)\left(  \int_\Omega |D^{\beta}_wf(y)|^p |\det Jg^{-1}\big|_{g(y)}|  dy\right)^{\frac{1}{p}}  \\
  											&=  \sum_{1\le |\beta|\le|\alpha| } C(l,M) \|D^{\beta}_wf \|_{L^p(\Omega)}					
\end{align*}
Thus, using the estimates for the intermediate derivatives, that
\[ \| Gf\|_{W^{l,p}(S^-)} =\| f(g)\|_{W^{l,p}(S^-)} \le C \| f\|_{W^{l,p}(\Omega)}\]
for a constant $C$ independent of $f$. In a similar way we can also prove that 
\[ \| G^{-1}f\|_{W^{l,p}(\Omega)}=\| f(g^{-1})\|_{W^{l,p}(\Omega)} \le D \| f\|_{W^{l,p}(S)}.\]
Now we can just define the operator $T$ as
\[  T=G^{-1} \circ \overline T \circ G\]
where $\overline T$ is the extension operator from $W^{l,p}(S^-)$ to $W^{l,p}(S)$ defined in Lemma $\ref{hestenes2}$. Therefore $T$ is bounded as composition of bounded operators. An explicit for for $T$ is

\[ Tf(x) = \begin{cases}
		f(x), & \text{if } x \in \Omega,\\
		\sum_{i=1}^l \alpha_k f(\overline x, \phi(\overline x)- \beta_k(x_n-\phi(\overline x))), & \text{if } x \in S \setminus \overline \Omega.
\end{cases} 
\]
\end{proof}

We are now ready to define the Hestenes operator for a general domain $\Omega$ with $C^m$ boundary. First we write the precise definition for this kind of domains.

\begin{definition}
Let $0<d\le D <\infty, M>0, \varkappa>0$ We say that an open set $\Omega$ in $\mathbb{R}^n$ has a resolved boundary with parameters $d,D, \varkappa$ if there exists a family of open cuboids $V_i , i=1,...,s$ (where $s \in \mathbb{N}$ if $\Omega$ is bounded and $s=\infty$ otherwise) such that
\begin{enumerate}
\item $(V_i)_d \cap \Omega \neq \emptyset$
\item $\Omega \subset \bigcup\limits_{j=1}^s (V_i)_d$
\item The multiplicity of the cover $\{ V_i\}_{i=1}^s$ is less than $ \varkappa$.
\item There exist isometries $\lambda_i$ of $\mathbb{R}^n$ such that
\[   \lambda_j(V_j)= \prod_{i=1}^n ]a_{ij},b_{ij}[\]
and, if $\partial V_j \cap \Omega \neq \emptyset$,
\[ \lambda_j(V_j\cap \Omega)= \{ (\overline x, x_n) \in \mathbb{R}^n  |  \overline x \in W_j , a_{nj}+d<x_n<\phi_j(\overline x)\} \]
where $W_j=\prod\limits_{i=1}^{n-1} ]a_{ij},b_{ij}[$ and $\phi_j : W_j \rightarrow \mathbb{R}$.

Moreover
\begin{itemize}
\item if $\phi_j \in C^m(\overline W_i)$ with  $\| D^{\alpha}\phi_j \|\le M <\infty $, for every $1\le|\alpha|\le m$, we say that $\Omega$  has a resolved $C^m$ boundary with parameters $d,D, \varkappa,M$.
\item if $\phi_j \in \Lip(\overline W_i)$ with  $\Lip(\phi)= M$,  we say that $\Omega$  has a resolved Lipschitz boundary with parameters $d,D, \varkappa,M$.
\end{itemize}
Finally we will say that a domain $\Omega$ has a resolved $C^m$ (or Lipschitz) boundary if there exist parameters $d,D,\varkappa,M$ for which $\Omega$ has a $C^m$ (or Lipschitz) boundary.
\end{enumerate}

\end{definition}

\begin{remark}\label{hestenesr}
In the notation of Lemma $\ref{hestenes1}$, let $a,b \in \rr$ such that $a<\phi(\overline x) <b$ for every $\overline x \in W$. We define $S^{a,b}=W\times (a,b)$, $\Omega_a=\Omega \cap (W \times (a,\infty))$ and $\widehat W^{l,p}(\Omega_a)=\{f \in W^{l,p}(\Omega_a) | \supp f \subset S\}$ . Then exists a bounded extension operator
\[ T: \widehat W^{l,p}(\Omega_a)\rightarrow W^{l,p}(S^{a,b}).\]
To see this we can just extend $f\in \widehat W^{l,p}(\Omega_a)$ naturally by 0 to  $f_0\in W^{l,p}(\Omega)$ and then define
\[ Tf=(\widetilde T f_0)\big|_{S^{a,b}}\]
where $\widetilde T$ is the operator of the previous Lemmma .
\end{remark}


\begin{theorem}\label{teorh}
Let $m,l \in \mathbb{N}, l\le m$ and $1\le p\le\infty$. If $\Omega$ is a domain in $\mathbb{R}^n$ has a $C^m$ resolved boundary then there exists a bounded extension operator
\[ T: W^{l,p}(\Omega) \rightarrow W^{l,p}(\mathbb{R}^n).\]
\end{theorem}
\begin{proof}[Proof Sketch]
Let $f \in W^{l,p}(\Omega)$. Let $\{V_i\}_{i=1}^s$ be the covering of cuboids for $\Omega$ as in Definition 1. It's possible to construct functions $\{ \psi_i \}_{i=1}^s \subset C^\infty_c(\mathbb{R}^n)$ such that the functions $\{ \psi^2_i \}_{i=1}^s$ form a partition of the unity corresponding to the covering $\{V_i\}_{i=1}^s$ and satisfying $\|D^\alpha \psi_i \|_{L^\infty}\le M_1$ with $M_1$ depending only on $n,l,d$.  If $\partial \Omega \cap V_i \neq \emptyset$ by Remark $\ref{hestenesr}$ there exists a bounded operator
\[ T_i : \widehat W^{l,p}(\lambda_i(\Omega \cap V_i))\rightarrow W^{l,p}(\lambda_i(V_i))\]
where $\widehat W^{l,p}(\lambda_i(V_i\cap \Omega)=\{f \in W^{l,p}(V_i\cap \Omega) | \supp f \subset \lambda_i(V_i)  \}.$ If $V_i \subset \Omega$ the operator $T_i$ is defined to be just the identity. We set
\[ Tf = \sum_{i=1}^s \psi_iT_i(\psi_if(\lambda_i^{-1}))(\lambda_i).\]
assuming ($\psi_iT_i(\psi_if(\lambda_i^{-1}))(\lambda_i))=0$ outside $V_i$. The functions $\psi_if \in W^{l,p}(V_i\cap \Omega)$ are such that $\supp \psi_if \subset \overline \Omega \cap V_i$, hence $\psi_i f(\lambda_i) \in \widehat W^{l,p}(\lambda_i(V_i\cap \Omega))$ and so $T$ is well defined. To see that $T$ is an extension operator, take $x \in \Omega$: if $x \in \supp \psi_i$ then $\psi_i(x)T_i(\psi_if(\lambda_i^{-1}))(\lambda_i(x))=\psi_i(x)^2 f(x)$ ; if $x \notin \supp \psi_i$ then $0=\psi_i(x)T_i(\psi_if(\lambda_i^{-1}))(\lambda_i(x))=\psi_i(x)^2 f(x)$. So $Tf(x)=\sum\limits_{i=1}^s \psi_i^2(x) f(x)=f(x)$. 

We omit the proof of the boundedness of $T$, the details of which can be found in the proofs of Lemma 13-14 in \cite{burenkov}.
\end{proof}

\subsection{Hestenes operator on Morrey spaces}

\begin{definition}
Let $1\le p< \infty$ , $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ be a domain in $\mathbb{R}^n$. For a function $f \in L^p_{loc}(\Omega)$ we define the Morrey space as
\[ M_p^\phi(\Omega)=\{f \in  L^p_{loc}(\Omega) \ |\  \|f\|_{M_p^\phi(\Omega)}<\infty\}\]
where
\[ \|f\|_{M_p^\phi(\Omega)}:=\sup_{B_r(x), x \in \Omega,r>0} \left(  \frac{1}{\phi(r)}\int_{B_r(x)\cap \Omega} |f(y)|^p dy \right )^{\frac{1}{p}}.\]

\end{definition}
\begin{lemma}\label{covering}
Let $k\ge 1$ and $\Omega$ be set in $\rr^n$ with diameter $D>0$. Then there exists an integer $C_{n,k}$ depending only on $k$ and $n$ such that $\Omega$ can be covered by a collection of open balls $B_1,...,B_h$ centered in $\Omega$ with radius $D/k$ and $h \le C_{k,n}.$
\end{lemma}
\begin{proof}
We start by claiming that if $S$ is a set of points in $\rr^n$ satisfying
\begin{enumerate}[i)]
\item  	$S \subset \Omega$,
\item $\|z_1-z_2 \|\ge D/k$ for every $z_1,z_2 \in \Omega$ with $z_1 \neq z_2$,
\end{enumerate}
then $\#S\le C_{n,k}$ where $C_{k,n}$ is an integer depending only on $k$ and $n$. To see this, first note that $\Omega$ is contained in some closed cube $Q$ of side $2D$. Then we choose $m \in \nn$ such that $2^{m-1}>\sqrt n k$. Next we cover $Q$ with $(2^m)^n$ smaller closed cubes of side $2D/2^m$. The diagonal of a smaller cube measures $2D/2^m \cdot \sqrt n < D/k$. Thus each of these cubes can contain at most one point of $S$ ,so $\#S\le (2^m)^n.$ Therefore it's enough to choose $C_{n,k}=2^{mn}.$ Set $r:=D/k$, we'll prove that we can cover $\Omega$ with a collection of balls $B_1,...,B_h$ centered in $\Omega$ of radius $r$ and such that $k\le C_{n,k}.$ Choose $x_1 \in \Omega$ and take $B_1=B_r(x_1)$, the ball centered in $x_1$ of radius $r$. If $\Omega \subset B_1$ we are done, if not there exists $x_2 \in \Omega\setminus B_1$ and we take $B_2=B_r(x_2).$ Again, if $\Omega \subset (B_1\cup B_2)$ we stop, otherwise we can pick $x_3 \in  \Omega\setminus (B_1 \cup B_2)$ and take $B_3=B_r(x_3).$ We iterate this procedure : given $B_1,...,B_i$ balls, if $ \Omega \subset (B_1\cup...\cup B_i)$ we stop, otherwise we can choose $x_{i+1} \in  \Omega \setminus (B_1\cup...\cup B_i)$ and take $B_{i+1}=B_r(x_{i+1}).$ We claim that this procedure stops with $i\le C_{n,k}.$ Suppose it doesn't, then we can find $B_1,...,B_{C_{n,k}+1}$ balls centered respectively at $x_1,...,x_{C_{n,k}+1}$. Setting $S= \{x_1,...,x_{C_{n,k}+1} \}$, it's immediate to see that $S$ satisfies i) and ii), but $\#S=C_{n,k}+1$, that is a contradiction.
\end{proof}

\begin{lemma}\label{lcircle}
Let $W \subset \mathbb{R}^{n-1}$ be open connected and define
\[\Omega =\{ (\overline x,x_n) \ |\ \overline x\in W, x_n\le \psi(\overline x)  \} \]
\[\Omega^+ =\{ (\overline x,x_n) \ |\ \overline x\in W, x_n> \psi(\overline x)  \} \]
where $\psi \in \Lip(\overline W)$. Let $\beta>0$ and consider the function $A_\beta$ from $W \times \rr$ to $\Omega$ defined by
\[ A_\beta(\overline x, x_n) =\begin{cases}
							(\overline x , \psi(\overline x)-\beta(x_n-\psi(\overline x))), & \text{if } (\overline x, x_n) \in \Omega^+ ,\\
							(\overline x, x_n), & \text{if } (\overline x, x_n) \in \Omega .\\
\end{cases}
\]
 Then for every $x_0 \in W \times \mathbb{R}$ and $r>0$
\[ A(B_r(x_0)\cap \Omega^+)\subset B_{cr}(A(x_0))\cap \Omega\]
where $c\ge 1$ is a constant depending only on $\Lip \psi$ and $\beta$.
\end{lemma}

\begin{proof}
Notice that it is sufficient to prove that for every $x,y \in W \times \mathbb{R}$ we have
\begin{equation}\label{circle}
 \|A(x)-A(y)\| \le c\|x-y \|.
\end{equation}
Set $M= \Lip \psi$. We distinguish three cases: 1. $x,y \in \Omega$ : in this case $A(x)=x$ and $A(y)=y$, so $\|x-y \| = \|A(x)-A(y)\|$ and there is nothing to prove.

2. $x,y \in \Omega^+$ : we have 
\begin{align*}
|A(x)_n-A(y)_n|&=|\psi(\overline x)-\beta(x_n-\psi(\overline x))-\psi(\overline y)+\beta(y_n-\psi(\overline y))| \\
				& \le (1+\beta)|\psi(\overline x)-\psi(\overline y)| + \beta|x_n-y_n|\\
				& \le M(1+\beta)\|\overline x -\overline y\| + \beta|x_n-y_n|
\end{align*}
Hence
\begin{align*}
\|A(x)-A(y)\|^2 &=\|\overline {A(x)} -\overline {A(y)}\|^2+|A(x)_n-A(y)_n|^2\\
& \le \|\overline x -\overline y\|^2+[M(1+\beta)\|\overline x -\overline y\| + \beta|x_n-y_n|]^2 \\
& \le (1+2M^2(1+\beta)^2)\|\overline x -\overline y\|^2+2\beta^2|x_n-y_n|^2 \\
& \le c_1^2(M,\beta)\|x-y\|^2
\end{align*}
for some constant $c_1(M,\beta)$.

3. $x \in \Omega^+, y \in \Omega$ : first notice that, since $\psi(\overline x) < x_n$, then $x_n-y_n>\psi(\overline x)-y_n$. Moreover $\psi(\overline y) > y_n$, hence $M\|\overline x -\overline y\| \ge \psi(\overline y)-\psi(\overline x)> y_n-\psi(\overline x).$ This implies
\[ |\psi(\overline x)-y_n |< |x_n-y_n|+M\|\overline x -\overline y\|.\]
Now
\begin{align*}
|A(x)_n-A(y)_n|&=|\psi(\overline x)-\beta(x_n-\psi(\overline x))-y_n| \\
				&=|(1+\beta)(\psi(\overline x)-y_n)+\beta(y_n-x_n)|\\
				&\le M(1+\beta)\|\overline x -\overline y\|+(1+2\beta)|x_n-y_n|
\end{align*}
and
\begin{align*}
\|A(x)-A(y)\|^2 &=\|\overline {A(x)} -\overline {A(y)}\|^2+|A(x)_n-A(y)_n|^2\\
& \le \|\overline x -\overline y\|^2+[M(1+\beta)\|\overline x -\overline y\|+(1+2\beta)|x_n-y_n|]^2 \\
& \le (1+2M^2(1+\beta)^2)\|\overline x -\overline y\|^2+2(1+2\beta)^2|x_n-y_n|^2 \\
& \le c_2^2(M,\beta)\|x-y\|^2.
\end{align*}
for some constant $c_2(M,\beta)$. Then $\eqref{circle}$ by taking $c=max(\sqrt c_1,\sqrt c_2,1)$.

\end{proof}



\begin{lemma}\label{hmorrey1}
Let $l,n,m \in \mathbb{N},m\ge l, 1\le p \le \infty$, $W = \prod\limits_{i=1}^{n-1}]a_i,b_i[$ be an open cuboid of $\mathbb{R}^{n-1}$ and $\phi$ a function from $\rr^+$ to $\rr^+$. Moreover define
\[ S=W \times \mathbb{R} \]
\[\Omega =\{ (\overline x,x_n) | \overline x\in W, x_n<\psi(\overline x)  \} \]
where $\psi \in C^m(\overline W)$ and $\| D^{\alpha}\psi \|\le M <\infty $ for every $1\le|\alpha|\le l$. Then for every $f \in W^{l,p}(\Omega)$  and  $1\le |\alpha|\le l$
\begin{align}
\| Tf\|_{M_p^\phi(S)} &\le    C\| f\|_{M_p^\phi(\Omega)} ,\\
\| D^\alpha_w Tf\|_{M_p^\phi(S)} &\le   C\sum_{1\le |\beta|\le|\alpha| }\| D^\beta_wf\|_{M_p^\phi(\Omega)},
\end{align}
where $T$ is the Hestenes operator defined in Lemma $\ref{hestenes1}$ and $C$ is a constant independent of $f$.
\end{lemma}

\begin{proof}
Define $\Omega^+ =\{ (\overline x,x_n) \ |\ \overline x\in W, x_n> \psi(\overline x)  \}$ . We recall the definition of $T$
\[ Tf(x) = \begin{cases}
		f(x) & x \in \Omega \\
		\sum_{i=1}^l \alpha_k f(\overline x, \psi(\overline x)- \beta_k(x_n-\psi(\overline x))) & x \in \Omega^+
\end{cases} 
\]
and observe that we can rewrite it as
\[ Tf(x) = \begin{cases}
		f(x), & \text{if }x \in \Omega, \\
		\sum_{i=1}^l \alpha_k f(G_k(x)), & \text{if } x \in \Omega^+,
\end{cases} 
\]
where $G_k(\overline x, x_n)=(\overline x, \psi(\overline x)- \beta_k(x_n-\psi(\overline x)))$. Note that $G_k: \Omega^+\rightarrow \Omega$ defines a diffeomorphism from $\Omega^+$ to $\Omega$ of class $C^m$ and satisfying $|\det JG_k^{-1}|\equiv 1/\beta_k.$ First we prove ii). Let's fix $x_0 \in S$ and a radius $r>0$. We want to estimate the quantity 
\[ I=\left ( \frac{1}{\psi(r)} \int_{B_r(x_0)\cap S} |D^\alpha_w Tf(x)|^pdx \right)^{\frac{1}{p}}\]
for $1\le|\alpha| \le l$. To do this we estimate the integral as follows

\[ I \le \underbrace{\left ( \frac{1}{\phi(r)} \int_{B_r(x_0)\cap \Omega^+} |D^\alpha_w Tf(x)|^pdx \right)^{\frac{1}{p}}}_\textrm{$I_1$}+\underbrace{\left ( \frac{1}{\phi(r)} \int_{B_r(x_0)\cap \Omega} |D^\alpha_w Tf(x)|^pdx \right)^{\frac{1}{p}}}_\textrm{$I_2$}.\]
Since $Tf(x)=f(x)$ when $ x\in\Omega$, we have immediately  
\[ I_2 \le \|D^\alpha_w f \|_{M_p^\phi(\Omega)} . \]
It remains to estimate $I_1$. We start by observing that from Lemma \ref{composition} there exists a constant $C_k$ depending only on $G_k$ and $l$ such that
\[ |D^{\alpha}_w (f \circ  G_k)| \le C_k \sum_{1\le |\beta|\le|\alpha| }| D^{\beta}_wf(G_k)|.\]
By the previous inequality and Lemma \ref{lcircle} we are able to produce the following bound
\begin{align*}
 \frac{\|D^{\alpha}_w(f \circ G_k) \|_{L^p(B_r(x_0)\cap \Omega^+)}}{\phi(r)^{\frac{1}{p}}} &\le C_k \sum_{1\le |\beta|\le|\alpha| } \left(\phi(r)^{-1} \int_{G_k(B_r(x_0)\cap \Omega^+)} |D^\beta_wf(y)|^p|\det JG_k^{-1}\big|_{G_k(y)}|dy\right)^{\frac{1}{p}}\\
 		&\le C_k \beta_k^{-\frac{1}{p}} \sum_{1\le |\beta|\le|\alpha| } \left(\phi(r)^{-1} \int_{B_{c_kr}(A_{\beta_k}(x_0))\cap \Omega} |D^\beta_wf(y)|^pdy\right)^{\frac{1}{p}} 		\\		
\end{align*}
where $A_{\alpha_k}$ is defined as in Lemma \ref{lcircle} and $c_k$ depends only on $\beta_k$ and $M$. By Lemma \ref{covering} the set $B_{c_kr}(A_{\beta_k}(x_0))\cap \Omega$ can be covered with a collection of open balls $B_1,...,B_h$ centered in $\Omega$ with radius $r$ and $h\le m_k$, where $m_k$ depends only on $c_k$. Hence we get
\[ \frac{\|D^{\alpha}_w(f \circ G_k) \|_{L^p(B_r(x_0)\cap \Omega^+)}}{\phi(r)^{\frac{1}{p}}}\le C_k \beta_k^{-\frac{1}{p}} m_k \sum_{1\le |\beta|\le|\alpha| } \|D^\beta f\|_{M_p^\phi(\Omega)}\]
 Next we estimate $I_1$:
\begin{align*}
I_1 = \phi(r)^{-\frac{1}{p}}|D^\alpha_w Tf \|_{L^p(B_r(x_0)\cap \Omega^+)}&\le \phi(r)^{-\frac{1}{p}} \sum_{k=1}^l \alpha_k \|D^\alpha_w f(G_k) \|_{L^p(B_r(x_0)\cap \Omega^+)} \\
&\le \sum_{k=1}^l \alpha_kC_k\beta_k^{-\frac{1}{p}}m_k \left( \sum_{1\le |\beta|\le|\alpha| }\| D^\beta_wf\|_{M_p^\phi(\Omega)} \right).																	
\end{align*}
Finally putting the estimates of $I_1,I_2$ together 
\begin{align*}
\| D^\alpha_w Tf\|_{M_p^\phi(S)}&=\sup_{x_0 \in S, r>0} \left ( \frac{1}{\phi(r)} \int_{B_r(x_0)\cap S} |D^\alpha_w Tf(x)|^pdx \right)^{\frac{1}{p}} \\
									&\le \|D^\alpha_w f \|_{M_p^\phi(\Omega)}+\sum_{k=1}^l \alpha_kC_k\beta_k^{-\frac{1}{p}}m_k \left( \sum_{1\le |\beta|\le|\alpha| }\| D^\alpha_wf\|_{M_p^\phi(\Omega)} \right) \\
									& \le \widetilde C\sum_{1\le |\beta|\le|\alpha| }\| D^\alpha_wf\|_{M_p^\phi(\Omega)}
\end{align*}
where $\widetilde C$ depends only on $\{b_k\}_k,\{\alpha_k\}_k,l,M,p$. This proves ii). The proof of i) is exactly analogous to the proof of ii).
\end{proof}
		

\begin{definition}
Let $1\le p< \infty$ , $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ be a domain in $\mathbb{R}^n$. For every $\delta>0$ and every function $f \in L^p_{loc}(\Omega)$ we define the norm $\|f\|_{M^{\delta,\phi}_p}$ as
\[\| f\|_{M^{\delta,\phi}_p} := \sup_{B_r(x), x \in \Omega, 0<r<\delta} \left(  \frac{1}{\phi(r)}\int_{B_r(x)\cap \Omega} |f(y)|^p dy \right )^{\frac{1}{p}}.\]
\end{definition}



\begin{theorem}
Let $m,l \in \mathbb{N}, l\le m$, $1\le p\le\infty$, $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ a domain in $\mathbb{R}^n$ with $C^m$ resolved boundary. Let also $ T$ be the Hestenes operator defined in Theorem \ref{teorh}. Then if $\Omega$ is bounded, for every $f \in W^{l,p}(\Omega)$ and $1\le |\alpha| \le l$ we have
\begin{align}
\| Tf\|_{M_p^\phi(\rr^n)} &\le    C\| f\|_{M_p^\phi(\Omega)}, \label{b0}\\
\| D^\alpha_w Tf\|_{M_p^\phi(\rr^n)} &\le   C\sum_{1\le |\beta|\le|\alpha| }\| D^\beta_wf\|_{M_p^\phi(\Omega)}, \label{bl}
\end{align}
where  $C$ doesn't depend on $f$. If instead $\Omega$ is unbounded, for every $f \in W^{l,p}(\Omega)$ and $\delta>0$ we have
\begin{align}
\| Tf\|_{M_p^{\phi,\delta}(\rr^n)} &\le    C_\delta\| f\|_{M_p^\phi(\Omega)}, \label{u0} \\
\| D^\alpha_w Tf\|_{M_p^{\phi,\delta}(\rr^n)} &\le   C_\delta\sum_{1\le |\beta|\le|\alpha| }\| D^\beta_wf\|_{M_p^\phi(\Omega)}, \label{ul}
\end{align}
where $C_\delta$ depends on $\delta$ but not on $f.$
\end{theorem}
\begin{proof}
Let $f \in W^{l,p}(\Omega)$ and  $\{V_i\}_{i=1}^s$ be the covering of cuboids for $\Omega$ as in the definition of set with resolved boundary. We recall the definition of $T:$
\[ Tf = \sum_{i=1}^s \psi_iT_i(\psi_if(\lambda_i^{-1}))(\lambda_i)\]
where $\{ \psi^2_i \}_{i=1}^s$ form a partition of the unity corresponding to the covering $\{V_i\}_{i=1}^s$ and satisfying $\|D^\alpha \psi_i \|_{L^\infty}\le M_1$, with $|\alpha|\le l$ and $M_1$ depending only on $n,l,d$. To make the notation simpler we will rewrite $T$ as
\[ Tf = \sum_{i=1}^s \psi_i\widetilde T_i(\psi_if)\]
where the operator $\widetilde T_i$ is defined as $\widetilde T_i f = T_i(f(\lambda_i^{-1}))(\lambda_i)$. 
Before starting the proof we remark some facts that will be justified at the end:
\begin{enumerate}[a)]

\item Let $C_i$ the constant such that
\[ \| T_ig\|_{M_p^\phi(\lambda_i(V_i))}\le C_i \|g\|_{M_p^\phi(\lambda_i(\Omega \cap V_i))},\]
\[\| D^\alpha_w T_ig\|_{M_p^\phi(\lambda_i(V_i)))} \le   C_i\sum_{1\le |\beta|\le|\alpha| }\| D^\alpha_wg\|_{M_p^\phi(\lambda_i(\Omega \cap V_i)))},\]  

for $1\le |\alpha|\le l$ and $g \in \widehat W^{l,p}(\lambda_i(\Omega \cap V_i))$. Then $\sup_{i=1,...,s} C_i \le M_2$, where $M_2$ depends only on $\Omega,l,n$.
\item We have
\[ \| \widetilde T_ig\|_{M_p^\phi(V_i)}\le M_2 \|g\|_{M_p^\phi(\Omega \cap V_i)},\]
\[\| D^\alpha_w \widetilde T_ig\|_{M_p^\phi(V_i)} \le   M_3M_2\sum_{1\le |\beta|\le|\alpha| }\| D^\alpha_wg\|_{M_p^\phi(\Omega \cap V_i)},\]  
for $1\le |\alpha|\le l$ and $g \in \widehat W^{l,p}(\Omega \cap V_i)$ and where $M_3$ doesn't depend on $i$. 
\end{enumerate}
Let now $x_0 \in \rr^n$, $0<r<\delta$ and $B_r(x_0)$ the ball centered in $x_0$ of radius $r.$ Let's consider the set $J=\{ i=1,...,s \ | \ V_i \cap B_r(x_0) \neq \emptyset\}.$
We notice that there exists an integer $\widetilde s$ depending only on the covering $(V_i)_{i=1}^s$ and on $\delta$ such that $\# J\le \widetilde s.$ We also recall that if $\Omega$ is bounded then $\widetilde s\le s<\infty$. We have



\begin{align*}
\left( \frac{1}{\phi(r)} \int_{B_r(x_0)} |Tf(x)|^pdx  \right)^{\frac{1}{p}} &=  \left( \frac{1}{\phi(r)} \int_{B_r(x_0)} |\sum_{i=1}^s \psi_i(x) \widetilde T_i(\psi_if))(x) |^pdx \right)^{\frac{1}{p}}\\
&\le \sum_{i \in J} \left( \frac{1}{\phi(r)} \int_{{B_r(x_0)} \cap V_i} | \widetilde T_i(\psi_if)(x)|^p |dx \right)^{\frac{1}{p}}\\
&\overset{b)}\le \widetilde s M_2\| \psi_i f\|_{M_p^\phi(V_i \cap \Omega)} \le M_2\widetilde s \| f\|_{M_p^\phi(\Omega)}.
\end{align*}
This proves \eqref{b0} and \eqref{u0}. Let now $\alpha \in \nn_0^n$ with $1\le|\alpha|\le l.$ We have 
\begin{align*}
\left( \frac{1}{\phi(r)} \int_{B_r(x_0)} |D^\alpha_w Tf(x)|^pdx  \right)^{\frac{1}{p}} &=  \left( \frac{1}{\phi(r)} \int_{B_r(x_0)} |D^\alpha_w \sum_{i=1}^s \psi_i(x) \widetilde T_i(\psi_if))(x) |^pdx \right)^{\frac{1}{p}}\\
&\le C_\alpha \sum_{i \in J} \left( \frac{1}{\phi(r)} \int_{{B_r(x_0)} \cap V_i} \sum_{\beta \le \alpha}|D^{\alpha -\beta}\psi_i(x) D^\beta_w \widetilde T_i(\psi_if)(x)|^p dx \right)^{\frac{1}{p}}\\
&\le C_\alpha M_1 \widetilde s \sum_{i \in J} \left( \frac{1}{\phi(r)} \int_{{B_r(x_0)} \cap V_i} \sum_{\beta \le \alpha}|D^\beta_w \widetilde T_i(\psi_if)(x)|^p dx \right)^{\frac{1}{p}}\\
&\overset{b)}\le C_\alpha M_1\widetilde s \sum_{\beta \le \alpha } M_2M_3 \sum_{|\gamma|\le |\beta|} \| D^\gamma_w f\|_{M_p^\phi(V_i)} \\
&  \le \widetilde C_\alpha M_1M_2M_3\widetilde s \sum_{|\beta| \le |\alpha|}\| D^\beta_w f\|_{M_p^\phi(V_i)} 
\end{align*}
This proves \eqref{bl} and \eqref{ul}. Let's now prove a) and b). a) $\Omega$ has a resolved $C^m$ boundary with parameters $\varkappa,d,D,M$. Hence, if $\phi_i$ are the $C^m$ functions of Definition 1, we have $\| D^{\alpha}\phi_i \|_{L^\infty}\le M$ for every $i$ and for every $1\le|\alpha|\le l$. Therefore by the proof of Lemma \ref{hmorrey1} we deduce that $C_i$ depends only on $l,n,M$ and on the choice of the constants $\alpha_k,\beta_k$, which can be chosen to be the same for every $T_i$.
b) We notice that since $\lambda_i$ are isometries, they are smooth and their derivatives are uniformly bounded with a bound depending only on $n$. Then the result follows from a) and from a straightforward computation using a change of variable and Lemma \ref{composition}.
\end{proof}
	
\section{Stein operator}

\subsection{Construction}
In this section we will define the Stein extension operator for Lipschitz domains in $\rr^n$. The details of the construction and the proofs of all the results in this subsection can be found in \cite[Section 2-3, Ch. VI]{stein}. We start by introducing the notion of regularized distance with the following theorem.

\begin{theorem}\label{regdist}
Let $F$ be a closed set in $\rr^n$ and denote $d(x,F)$ the distance of $x$ from $F$. Then there exists a function $\Delta(x)=\Delta(x,F)$ defined in $F^c$ such that
\begin{enumerate}[a)]
\item $c_1 d(x,F)\le \Delta(x)\le c_2d (x,F),$  
\item $\Delta(x)$ is $C^\infty$ in $F^c$ and
\[ \left | D^\alpha \Delta(x) \right | \le B_\alpha d(x,F)^{1-|\alpha|},\]
\end{enumerate}
where $B_\alpha$, $c_1$,$c_2$ are constants independent of $F$ and $d(x,F)$ is the distance of $x$ from $F.$
\end{theorem}
Next we give the definition of a special Lipschitz domain.
\begin{definition}
A domain $\Omega$ of $\rr^n$ it's said to be a special Lipschitz domain if exists a Lipschitz function $\psi$ defined from $\rr^{n-1}$ to $\rr$ such that
\[ \Omega=\{(\overline x, y) \in \rr^n \ | \ \psi(\overline x)<y \}.\]
Moreover the constant $\Lip \psi$ is said to be the Lipschitz bound of $\Omega.$ 
\end{definition}
It's convenient to define first the Stein extension operator in the case of a special Lipschitz domain, to do this we need the following two lemmas.
\begin{lemma}\label{lemma1}
Let $\Omega$ be a special Lipschitz domain of $\rr^n$ and set $F=\overline \Omega$. Suppose $\Delta(\overline x, y)$ is the regularized distance from $F$ as given in Theorem \ref{regdist}. Then there exists a constant $a$, which depends only on the Lipschitz bound of $\Omega$, so that if $(\overline x, y) \in F^c$, then $a\Delta(\overline x,y)\ge \psi(\overline x)- y.$
\end{lemma}

\begin{lemma}\label{lemma2}
There exists a continuous function $\tau$ defined in $[1,\infty)$ satisfying
\begin{enumerate}[i)]
	\item $\tau(\lambda)=O(\lambda^N)$, as $\lambda \rightarrow \infty$ for every $N,$
	\item $\int_1^\infty \tau(\lambda)d\lambda=1$, $\int_1^\infty \lambda^k\tau(\lambda)d\lambda=0$, for every $k=1,2,...$
\end{enumerate}
\end{lemma}


\begin{theorem}\label{defT}Let $\Omega$ be a special Lipschitz domain of $\rr^n$ with Lipschitz bound $M$. Moreover let $\tau$ be the function in Lemma \ref{lemma2} and $a$ the constant of Lemma \ref{lemma1}. For every function $f$ that is $C^\infty$ in $\overline \Omega$ and bounded in $\overline \Omega$ together with all its partial derivatives, define
\[ Tf(\overline x, y)= \begin{cases}
						f(\overline x, y), & \text{ if } y\ge\psi(\overline x) \\
						\int_1^\infty f(\overline x, y+ \lambda \delta^*(\overline x,y))\tau(\lambda)d\lambda, & \text{ if } y<\psi(\overline x),		
\end{cases}
\]
where $\delta^*(\overline x,y)=2a\Delta(\overline x, y).$ Then $Tf \in C^\infty(\rr^n)$ and 
\[\| Tf\|_{W^{l,p}(\rr^n)}\le C_{n,l}(M) \| f\|_{W^{l,p}(\Omega)} ,\]
where $C_{l,n}(M)$ is a constant depending only on $n,l$ and $M.$
\end{theorem}

We are now ready to define the Stein extension operator in the case of special Lipschitz domains. The construction is the following. Let $\Omega$ be a special Lipschitz domain in $\rr^n$ with Lipschitz bound $M$. We denote with $\Gamma$ the cone with vertex at the origin given by $\Gamma=\{(\overline x, y) \in \rr^n \ | \ M |\overline x|<|y|, y<0 \}$. Suppose now that $\eta \in C^\infty_c(\rr^n)$ is a non-negative function with total integral 1 and which support is contained in $\Gamma.$ For every $f \in W^{l,p}(\Omega)$ and every $\varepsilon>0$ we define
\[f_\varepsilon(x)=\frac{1}{\varepsilon^n}\int_{\rr^n} f(x-y) \eta(y/\varepsilon)dy =\int_{\rr^n} f(x-\varepsilon y) \eta(y)dy.\]
Notice that, since the support of $\eta$ is strictly inside $\Gamma$, the above integral is well defined for every $x$ in some neighborhood of $\overline \Omega$ depending on $\varepsilon$. Hence $f_\varepsilon \in C^\infty(\overline\Omega)$ and it is bounded with all its partial derivatives, thus $Tf_\varepsilon$ is well defined. The Stein operator is then taken to be the limit of $Tf_\varepsilon$ as $\varepsilon \to 0.$ This limit procedure is formalized in the following result.

\begin{theorem}\label{Sdef}
Let $l \in \nn,1\le p \le \infty$ and $\Omega$ be a special Lipschitz domain of $\rr^n$ with Lipschitz bound $M$. For every $f \in W^{l,p}(\Omega)$ define $Tf_\varepsilon$ as above. Then $Tf_\varepsilon $ converges in $W^{l,p}(\rr^n)$ if $p<\infty$ and in $W^{l-1,p}(\rr^n)$ if $p=\infty$, as $\varepsilon \to 0.$ Moreover setting
\[ Sf=\lim_{\varepsilon \to 0} Tf_\varepsilon\]
we have that $Sf$ extend $f$ to $\rr^n$ and 
\[ \| Sf\|_{W^{l,p}(\rr^n)} \le C_{l,n}(M) \| f\|_{W^{l,p}(\Omega) } ,\] 
where $C_{l,n}(M)$ is a constant depending only on $n,l$ and $M.$
\end{theorem}





\subsection{Stein operator in Sobolev-Morrey spaces}

\begin{definition}
Let $x$ be a point in $\rr^n$ and $r>0$. We define the open cube centered in $x$ of side $l$ as the set 
\[ Q_l(x)=(x_1-l/2,x_1+l/2) \times (x_2-l/2,x_2+l/2) \times \cdots \times (x_n-l/2,x_n+l/2)   \]
where $x=(x_1,...,x_n).$
\end{definition}


\begin{definition}
Let $1\le p< \infty$ , $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ be a domain in $\mathbb{R}^n$. For a function $f \in L^p_{loc}(\Omega)$ we define the norm $\| .\|_{M_{p,Q}^\phi(\Omega)}$ as
\[ \|f\|_{M_{p,Q}^\phi(\Omega)}:=\sup_{Q_{2r}(x), x \in \Omega,r>0} \left(  \frac{1}{\phi(r)}\int_{Q_r(x)\cap \Omega} |f(y)|^p dy \right )^{\frac{1}{p}}\]
where $Q_{2r}(x)$ is the open cube centered in $x$ of side $2r$.
\end{definition}
\begin{lemma}\label{cubicmorrey}
Let $1\le p\le \infty$ , $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ be a domain in $\mathbb{R}^n$. Then then norm $\| .\|_{M_{p,Q}^\phi(\Omega)}$ is equivalent to the classical Morrey norm $\|.\|_{M_{p}^\phi(\Omega)}$. In particular 
\[ \| .\|_{M_{p}^\phi(\Omega)} \le \| .\|_{M_{p,Q}^\phi(\Omega)}\le C_{n}\| .\|_{M_{p}^\phi(\Omega)}\]
where $C_n$ is a constant depending only on $n.$
\end{lemma}

\begin{proof}
We prove first the second inequality of the statement. Let $x \in \Omega$, $r>0$, $Q_{2r}(x)$ be the cube centered in $x$ of side $2r$ and $f \in L^p_{loc}(\Omega)$. Since the set $Q_{2r}(x) \cap \Omega$ has diameter less than $2r\sqrt n$ by Lemma \ref{covering} there exists a collection of balls $B_1,...,B_k$ centered in $Q_{2r}(x) \cap \Omega$ of radius $r$, with $k\le C_n$ where $C_n$ depends only on $n.$ Hence 
\[ 	\int_{Q_{2r}(x)\cap\Omega} |f(y)|^p dy \le \sum_{i=1}^k \int_{B_i\cap\Omega} |f(y)|^p dy\]
and
\[ \| f\|_{M_{p,Q}^\phi(\Omega)}=\sup_{Q_{2r}(x) ,x \in \Omega,r>0} \left( \frac{1}{\phi(r)}\int_{Q_{2r}(x)\cap\Omega} |f(y)|^p dy \right)^{\frac{1}{p}} \le C_n \| f\|_{M_p^\phi(\Omega)}.\]
To prove the first inequality we observe that for every $x \in \Omega$ and $r>0$, $(B_r(x)\cap\Omega)\subset (Q_{2r}(x)\cap\Omega)$, where $Q_{2r}(x)$ is the cube centered in $x$ with side $2r$ and $B_r(x)$ is the ball of radius $r$ centered in $x$. Therefore for every $f \in L^p_{loc}(\Omega)$
\[ \int_{B_r(x)\cap\Omega} |f(y)|^p dy \le \int_{Q_{2r}(x)\cap\Omega} |f(y)|^p dy\]
and this concludes the proof.

\end{proof}

\begin{lemma}\label{derivatives}
Let $\Omega$ be an open set in $\rr^n$ and let $f,h \in C^\infty(\rr^n)$. Define the function $g\in C^\infty(\rr^n)$ as $g(x)=f(\overline x, x_n+\lambda h(x))$ where $\overline x=x_1,...,x_{n-1}$ and $0\neq\lambda \in \rr.$ Then for every $\alpha \in \nn_0^n$ and $x \in \rr^n$ the number $D^\alpha g(x)$ is a finite sum of terms of the following form

\[
c\lambda^s D^{\beta} f(\overline x, x_n+\lambda h(x))(D^{\gamma_1}h(x))^{n_1}\cdots (D^{\gamma_k}h(x))^{n_k}
\]
for some constant $c$, with $\beta,\gamma_i \in \nn_0^n $, $k,s,n_i \in \nn_0$ and $\beta,\gamma_i\neq0$, $k,s\ge 0$, $n_i>0$. Moreover every term satisfies the following conditions
\begin{enumerate}[a)]
\item $n_1(|\gamma_1|-1)+n_2(|\gamma_2|-1)+...+n_k(|\gamma_k|-1)=|\alpha|-|\beta|$,
\item  $s=0$ if and only if $k=0$.
\end{enumerate}
\end{lemma}

\begin{proof}
We will prove the result by induction on $l=|\alpha|.$ Let's prove the case $l=1$. For every $i=1,...,n$ we have
\[ \frac{\partial g}{\partial x_i}(x)=\frac{\partial f}{\partial x_i}(\overline x, x_n+\lambda h(x))+\lambda\frac{\partial f}{\partial x_n}(\overline x, x_n+\lambda h(x))\frac{\partial h}{\partial x_i}(x) \]
that clearly satisfies the statement. We assume now that the result is true for $l$, and suppose $|\alpha|=l+1$. We write $D^\alpha g(x)=\frac{\partial D^\beta g}{\partial x_i}(x)$ for some $|\beta|=l$. Hence by induction hypothesis and linearity of the derivative we have that $D^\alpha g(x)$ is a finite sum of terms of the form
\[ \frac{\partial}{\partial x_i} [c\lambda^s D^{\gamma} f(\overline x, x_n+\lambda h(x))(D^{\gamma_1}h(x))^{n_1}\cdots (D^{\gamma_k}h(x))^{n_k}].\]
Suppose first that $k\ge 1,$ so by induction we know that
\begin{equation}\label{indder}
 n_1(|\gamma_1|-1)+n_2(|\gamma_2|-1)+...+n_k(|\gamma_k|-1)=|\beta|-|\gamma| 
 \end{equation}
 and that $s\ge 1.$
 Now expanding the derivation using the chain rule we get
\begin{align*}
&\frac{\partial}{\partial x_i} [c\lambda^s D^{\gamma} f(\overline x, x_n+\lambda h(x))(D^{\gamma_1}h(x))^{n_1}\cdots (D^{\gamma_k}h(x))^{n_k}]=\\
&=c\lambda^s \frac{\partial D^{\gamma} f}{\partial x_i}  (\overline x, x_n+\lambda h(x))(D^{\gamma_1}h(x))^{n_1}\cdots (D^{\gamma_k}h(x))^{n_k}+\\
&+ c\lambda^{s+1} \frac{\partial D^{\gamma} f}{\partial x_n}  (\overline x, x_n+\lambda h(x))(D^{\gamma_1}h(x))^{n_1}\cdots (D^{\gamma_k}h(x))^{n_k}\frac{\partial h}{\partial x_i} (x)+\\
&+ \sum_{j=1}^k c\lambda^sn_j D^{\gamma} f(\overline x, x_n+\lambda h(x))(D^{\gamma_1}h(x))^{n_1}\cdots (D^{\gamma_k}h(x))^{n_k} \frac{\frac{\partial D^{\gamma_j}h}{\partial x_i} (x)}{D^{\gamma_j}h(x)}.
\end{align*}
Let's see that every term satisfies a). By \eqref{indder} we have
\[ n_1(|\gamma_1|-1)+n_2(|\gamma_2|-1)+...+n_k(|\gamma_k|-1)=|\beta|-|\gamma|=|\alpha|-|\gamma + e_i|\]
where $e_i=(0,...,\underset{i}1,...,0),$ hence that first summand satisfies a). Again by \eqref{indder}
\[ n_1(|\gamma_1|-1)+n_2(|\gamma_2|-1)+...+n_k(|\gamma_k|-1)+(|e_i|-1)=|\alpha|-|\gamma + e_n|\]
and this proves a) for the second term. Now we consider the final sum, we will prove a) just for $j=1$, the other terms are dealt in the same way. We need to prove that
\[ n_1(|\gamma_1|-1)+...+(n_j-1)(|\gamma_j|-1)+...+n_k(|\gamma_k|-1)+(|\gamma_j+e_i|-1)=|\alpha|-|\gamma|. \]
Expanding the left-hand side we get
\[ n_1(|\gamma_1|-1)+n_2(|\gamma_2|-1)+...+n_k(|\gamma_k|-1)+1\]
and since $|\beta|=|\alpha|-1$ we conclude using \eqref{indder}. We observe that, since $k,s\ge1$, all the terms also satisfies b). Suppose know that $k=0$, hence we need to consider
\[ \frac{\partial}{\partial x_i} [c D^{\gamma} f(\overline x, x_n+\lambda h(x)) ]\]
that becomes

\[ c \frac{\partial D^{\gamma} f}{\partial x_i} (\overline x, x_n+\lambda h(x)) + c\lambda \frac{\partial D^{\gamma} f}{\partial x_n} (\overline x, x_n+\lambda h(x)) \frac{\partial h}{\partial x_i}(x). \]
By induction and by a) we know that $|\gamma|=|\beta|,$ therefore it's immediate that both the above terms satisfies a) and b).

\begin{remark}\label{deltastar}
Let $\Omega$ a special Lipschitz domain and let $\delta^*(\overline x, y)$ be the function defined in Theorem \ref{defT}. Then for every $(\overline x, y)$ with $\psi(\overline x)>y$ the following holds
\[c(\psi(\overline x)-y) \ge \delta^*(\overline x, y) \ge 2 (\psi(\overline x)-y), \] 
where $c$ is some constant depending only on $n.$ The second inequality follows directly from the definition of $\delta^*$ and Lemma \ref{lemma1}. Next we notice that $(\psi(\overline x)-y)\ge d(x,\overline \Omega)$, hence the first inequality follows from a) of Theorem \ref{regdist}.
\end{remark}

\end{proof}
\begin{lemma}\label{Tlemma}
Let $1\le p<\infty,n\ge2$, $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ be a special Lipschitz domain of $\rr^n$ with Lipschitz bound $M.$ Moreover let $T$ be the operator defined in Theorem \ref{defT} and $f \in C^\infty(\overline \Omega)$ be a function bounded in $\overline \Omega$ together with all its partial derivatives. Then  for every $\alpha \in \nn_0^n$
\begin{equation}
 \| D^\alpha Tf\|_{M_p^\phi(\rr^n)}\le C_{l,n}(M)\sum_{|\beta|\le |\alpha|}\|D^\beta f \|_{M_p^\phi(\Omega)} \label{Tbound2}
 \end{equation}
where $l=|\alpha|$ and $C_{l,n}(M)$ is a constant depending only on $l,n$ and $M.$
\end{lemma}
\begin{proof}
Let's start by proving the case $l=0$. By Lemma \ref{cubicmorrey} it's enough to prove that for an arbitrary open cube $Q$ of side $r$ in $\rr^n$ with sides parallel to the axis we have
\begin{equation}
\left(\frac{1}{\phi(r/2)}\int_Q |Tf(x)|^pdx \right)^{\frac{1}{p}} \le C_n(M) \| f\|_{M_{p,Q}^\phi(\Omega)}
\end{equation}
for a constant $C_n(M)$ depending only on $n,M$. Let's define  $\Omega^- = \{ (\overline x , y) \in \rr^n \ | \ \overline x \in \rr^{n-1}, \ y<\psi(\overline x) \}$. There are three cases: 1. $Q \subset \Omega$ 2. $Q \subset \Omega^-$ 3. $Q\cap \{y=\psi(\overline x)\} \neq \emptyset.$ 

1. Since $Tf=f$ in $\Omega$
\[ \left(\frac{1}{\phi(r/2)}\int_Q |Tf(x)|^pdx \right)^{\frac{1}{p}}=\left(\frac{1}{\phi(r/2)}\int_Q |f(x)|^pdx \right)^{\frac{1}{p}} \le  \| f\|_{M_{p,Q}^\phi(\Omega)}\]
and we are done.

2. Let's write $Q$ as $Q=\{ (\overline x,y) \in \rr^n \ | \ \overline x \in F, y \in (a-r,a) \}$ where $F$ is an open cube of $\rr^{n-1}$ of side $r$ and $a<\phi(\overline x)$ for every $\overline x \in F$. Fix now $(\overline x, y) \in Q$. By Lemma \ref{lemma2} there exists a constant $A_3$ such that $|\tau(\lambda)|\le A_3/\lambda^3$  for every $\lambda \ge 1.$ From the definition of $Tf$ we have
\[ |Tf(\overline x,y)| \overset{(\bullet)}\le\int_1^\infty |f(\overline x, y+\lambda \delta^*(\overline x,y))||\tau(\lambda)|d\lambda \le A_3 \int_1^\infty |f(\overline x, y+\lambda \delta^*(\overline x,y))|\frac{1}{\lambda^3}d\lambda\]
Let's apply the change of variable $s=y+\lambda \delta^*(\overline x,y)$
\[ |Tf(\overline x,y)|\overset{(\bullet \bullet)}\le A_3\int_{y+\delta^*}^\infty |f(\overline x, s)|\frac{(\delta^*)^2}{(s-y)^3}ds\le A_3 c^2 \int_{2\psi(\overline x)-y}^\infty |f(\overline x, s)|\frac{(\psi(x)-y)^2}{(s-y)^3}ds\]
because $c(\psi(x)-y)\ge\delta^*\ge 2(\psi(x)-y)$ as seen in Remark \ref{deltastar}. Let's now decompose the last integral as follows
\[ |Tf(\overline x,y)|\le \sum_{k=0}^\infty A_3c^2\int_{2\psi(\overline x)-y+kr}^{2\psi(\overline x)-y+(k+1)r} |f(\overline x, s)|\frac{(\psi(\overline x)-y)^2}{(s-y)^3}ds.\]
Now by applying Minkowski's inequality for an infinite sum we get
\[ \left(\int_{a-r}^{a}|Tf(\overline x,y)|^p dy\right)^{\frac{1}{p}}\le A_3 c^2\sum_{k=0}^\infty \left( \int_{a-r}^{a}\left ( \int_{2\psi(\overline x)-y+kr}^{2\psi(\overline x)-y+(k+1)r} \frac{|f(\overline x, s)|(\psi(x)-y)^2}{(s-y)^3}ds\right)^pdy \right)^{\frac{1}{p}} (*)\]
Next we plan to estimate each summand. In the right-hand side of (*) we apply the change of variable $y=\psi(\overline x)-z$ 
\[ \left( \int_{\psi(x)-a}^{\psi(x)-a+r}\left (\int_{\psi(x)+z+kr}^{\psi(x)+z+(k+1)r} |f(\overline x, s)|\frac{z^2}{(s-\psi(x)+z)^3}ds\right)^pdz \right)^{\frac{1}{p}}\]
and the change of variable $u=s-\psi(x)$
\[ \left( \int_{\psi(x)-a}^{\psi(x)-a+r}\left (\int_{z+kr}^{z+(k+1)r} |f(\overline x, u+\psi(x))|\frac{z^2}{(u+z)^3}du\right)^pdz \right)^{\frac{1}{p}}.\]
Then we apply the change of variable $t=u/z$
\[ \left( \int_{\psi(\overline x) - a}^{\psi(\overline x) -a+r}\left (\int_{1+kr/z}^{1+(k+1)r/z} |f(\overline x, tz+\psi(x))|\frac{1}{(t+1)^3}dt\right)^pdz \right)^{\frac{1}{p}}.\]
that can be rewritten as
 \[  \left( \int_{\psi(\overline x) -a}^{\psi(\overline x) -a+r}\left (\int_{1+kr/(\psi(\overline x) -a+r)}^{1+(k+1)r/(\psi(\overline x)-a)} |f(\overline x, tz+\psi(x))|\mathbbm{1}_{(1+kr/z,  1+(k+1)r/z ) }(t)\frac{1}{(t+1)^3}dt\right)^pdz \right)^{\frac{1}{p}}.\]
 By Minkowsi's integral inequality and setting $\alpha=r/(\psi(\overline x)-a)$
 \begin{align*}
  & \left( \int_{a\psi(\overline x) -a}^{\psi(\overline x) -a+r}\left (\int_{1+k\alpha/(\alpha+1)}^{1+(k+1)\alpha} |f(\overline x, tz+\psi(x))|\mathbbm{1}_{(1+kr/z,  1+(k+1)r/z ) }(t)\frac{1}{(t+1)^3}dt\right)^pdz \right)^{\frac{1}{p}}. \\
  &\le \int_{1+k\alpha/(\alpha+1)}^{1+(k+1)\alpha} \left ( \int_{\psi(\overline x) -a}^{\psi(\overline x) -a+r}|f(\overline x, tz+\psi(x))|^p\mathbbm{1}_{(1+kr/z,  1+(k+1)r/z ) }(t)\frac{1}{(t+1)^{3p}} dz \right) ^{\frac{1}{p}}dt.  
 \end{align*}
 We notice that for every $t,z \in \rr$ with $\psi(\overline x) -a \le z \le \psi(\overline x)-a+r$
 \[ \mathbbm{1}_{(1+kr/z,  1+(k+1)r/z ) }(t) \le \mathbbm{1}_{(\psi(\overline x)-a+kr, \psi(\overline x) - a+(k+2)r)}(tz)   \]
 hence using the change of variable $w=tz$
 \begin{align*}
 &\int_{1+k\alpha/(\alpha+1)}^{1+(k+1)\alpha} \left ( \int_{\psi(\overline x)-a+kr}^{\psi(\overline x)-a+(k+2)r}|f(\overline x, tz+\psi(x))|^p\mathbbm{1}_{(1+kr/z,  1+(k+1)r/z ) }(t)\frac{1}{(t+1)^{3p}} dz \right) ^{\frac{1}{p}}dt \\
&\le \int_{1+k\alpha/(\alpha+1)}^{1+(k+1)\alpha} \left ( \int_{\psi(\overline x)-a+kr}^{\psi(\overline x)-a+(k+2)r}|f(\overline x, w+\psi(\overline x))|^p \frac{1}{t(t+1)^{3p}} dw \right) ^{\frac{1}{p}}dt\\
&=\int_{1+k\alpha/(\alpha+1)}^{1+(k+1)\alpha}\frac{1}{t^{\frac{1}{p}}(t+1)^{3}}dt \left ( \int_{\psi(\overline x)-a+kr}^{\psi(\overline x)-a+(k+2)r}|f(\overline x, w+\psi(\overline x))|^p  dw \right) ^{\frac{1}{p}}\\
&\le \int_{1+k\alpha/(\alpha+1)}^{1+(k+1)\alpha}\frac{1}{(t+1)^{3}}dt \left ( \int_{\psi(\overline x)-a+kr}^{\psi(\overline x)-a+(k+2)r}|f(\overline x, w+\psi(\overline x))|^p  dw \right)\\
&= \frac{1}{2}\left[\frac{1}{(1+(k+1)\alpha)^2}-\frac{1}{(1+k\alpha/(\alpha+1))^2}\right] \left ( \int_{\psi(\overline x)-a+kr}^{\psi(\overline x)-a+(k+2)r}|f(\overline x, w+\psi(\overline x))|^p  dw \right) ^{\frac{1}{p}}\\
&=\frac{s_k(\alpha)}{2} \left ( \int_{\psi(\overline x)-a+kr}^{\psi(\overline x)-a+(k+2)r}|f(\overline x, w+\psi(\overline x))|^p  dw \right) ^{\frac{1}{p}}.
\end{align*}
Plugging this estimate inside (*) we get
\begin{align*}
 \left(\int_{a-r}^{a}|Tf(\overline x,y)|^p dy\right)^{\frac{1}{p}} &\le A_3\frac{c^2}{2} \sum_{k=0}^\infty s_k(\alpha) \left ( \int_{\psi(\overline x) -a+kr}^{\psi(\overline x) -a+(k+2)r}|f(\overline x, w+\psi(\overline x))|^p  dw \right) ^{\frac{1}{p}} \\
&=A_3\frac{c^2}{2} \sum_{k=0}^\infty s_k(\alpha) \left ( \int_{2\psi(\overline x) -a+kr}^{2\psi(\overline x) -a+(k+2)r}|f(\overline x, y)|^p  dy \right) ^{\frac{1}{p}}.
\end{align*}
Taking the $L^p$ norm on $F$ on both sides and applying again Minkowski inequality we obtain
\begin{align*}
\left(\int_F\int_{a-r}^{a}|Tf(\overline x,y)|^p dy d\overline x\right)^{\frac{1}{p}} &\le A_3 \frac{c^2}{2} \sum_{k=0}^\infty s_k(\alpha) \left (\int_F \int_{2\psi(\overline x) -a+kr}^{2\psi(\overline x) -a+(k+2)r}|f(\overline x, y)|^p  dy d\overline x\right) ^{\frac{1}{p}}\\
&=A_3 \frac{c^2}{2} \sum_{k=0}^\infty s_k(\alpha) \|f\|_{L^p(S_k)}. \tag{**}\\
\end{align*}
where $S_k=\{ (\overline x, y) \in \rr^n \ | \ \overline x \in F ,\  2\psi(\overline x) -a+kr < y < 2\psi(\overline x) -a+(k+2)r \}$. Clearly the set $S_k$ has diameter less than $dr$, where $d$ is a constant depending only on $n$ and $M$. Hence by Lemma \ref{covering} there exists a collection of open cubes $Q_1,...,Q_m$ centered in $S_k$ of side $r$ that covers $S_k$, with $m \in \nn$ depending only on $M$ and $n$. Moreover for every $(\overline x, y ) \in S_k$ we have $y>2\psi(\overline x)-a>\psi(\overline x)$, so $S_k \subset \Omega$. This implies that
\[ S_k \subset \bigcup_{i=1}^m (Q_i\cap \Omega) \]
and that every cube $Q_i$ is centered in $\Omega.$ Therefore by (**) 
\[ \| Tf\|_{L^P(Q)} \le \frac{c^2}{2}\sum_{k=0}^\infty s_k(\alpha) (\|f\|_{L^p(Q_1\cap \Omega)}+...+\|f\|_{L^p(Q_m\cap \Omega)}),\]
 then dividing in both sides by $\psi(r/2)^{\frac{1}{p}}$ we obtain
\[\left(\frac{1}{\phi(r/2)}\int_Q|Tf(x)|^p dx\right)^{\frac{1}{p}} \le \frac{A_3c^2m}{2} \sum_{k=0}^\infty s_k(a,r) \| f\|_{M_{p,Q}(\Omega)} \]
We want now to estimate the series $\sum_{k=0}^\infty s_k(\alpha)$. First we notice that can be rewritten as as
\[\sum_{k=0}^\infty s_k(\alpha)= \sum_{k=1}^\infty \frac{\alpha(\alpha+2)}{(k\alpha+1)^2}.\]
To bound this series we distinguish two cases, when $\alpha\le 1$ and when $\alpha>1$. In the first case we can bound the series using a Riemann Sum
\[ \sum_{k=1}^\infty \frac{\alpha(\alpha+2)}{(k\alpha+1)^2} \le 3\sum_{k=1}^\infty \frac{\alpha}{(k\alpha+1)^2}=3\sum_{k=1}^\infty \int_{\rr} \mathbbm{1}_{(\alpha (k-1), \alpha k)}(t) \frac{1}{(\alpha k+1)^2}dt \le 3\int_{\rr}\frac{1}{(t+1)^2}dt=3. \]
In the second case
\[  \sum_{k=1}^\infty \frac{\alpha(\alpha+2)}{(k\alpha+1)^2}  \le \sum_{k=1}^\infty \frac{\alpha(\alpha+2)}{k^2\alpha^2}=\sum_{k=1}^\infty \frac{1+\frac{2}{\alpha}}{k^2} \le 3 \frac{\pi^2}{6}<5.\]
Hence we get 
\[\left(\frac{1}{\phi(r/2)}\int_Q|Tf(x)|^p dx\right)^{\frac{1}{p}} \le A_35c^2 \| f\|_{M_{p,Q}^\phi(\Omega)} \]
that shows (1). 

3. We write $Q$ as $F \times (a-r,a)$ and and we define $Q^+=Q\cap\Omega$ and $Q^-=Q\cap\Omega^-.$ Then 
\[\|Tf\|_{L^p(Q)}\le\|f\|_{L^p(Q^+)}+\|Tf\|_{L^p(Q^-)}.\]
Moreover $Q^+$ can be written as $\{ (\overline x, y) \ | \ \overline x \in S, a-r<y<\min(\psi(\overline x),a)\}$ for some set $S \subset F.$ Hence
\[ \int_{Q^-} |Tf(x)|^pdx = \int_S \int_{a-r}^{\min(\psi(\overline x),a)} |Tf(\overline x,y)|^pdy d\overline x. \]
We can then proceed as in 2. to obtain
\begin{align*}
 \left(\int_S\int_{a-r}^{a}|Tf(\overline x,y)|^p dy d\overline x\right)^{\frac{1}{p}} &\le A_3\frac{c^2}{2} \sum_{k=0}^\infty s_k(\alpha) \left (\int_S \int_{2\psi(\overline x) -\min(a,\psi(\overline x)) +kr}^{2\psi(\overline x) -a+(k+2)r}|f(\overline x, y)|^p  dy d\overline x\right) ^{\frac{1}{p}}\\
 &=A_3\frac{c^2}{2} \sum_{k=0}^\infty s_k(\alpha) \|f\|_{L^p(S'_k)}.
 \end{align*}
One can observe that the sets $S'_k$ have the same property as the sets $S_k$ in 2. Therefore
\[ \frac{1}{\psi(r/2)^{\frac{1}{p}}} \| Tf\|_{L^p(Q^-)} \le c_1 \| f\|_{M_p^\phi(\Omega)} \]
for some constant $c_1$ depending only on $n$ and $M$. Finally it's immediate to verify that $\| f\|_{L^p(Q^+)} \le \phi(r/2)^{\frac{1}{p}} \| f\|_{M_p^\phi(\Omega)}.$ This concludes the proof of case 3.

We consider now the case $l>0.$ By Lemma \ref{cubicmorrey} it's again enough to prove that for an arbitrary open cube $Q$ of side $r$ contained in $\rr^n$ we have
\begin{equation}
\left(\frac{1}{\phi(r/2)}\int_Q |D^\alpha Tf(x)|^pdx \right)^{\frac{1}{p}} \le C_{l,n}(M) \sum_{|\beta| \le |\alpha|}\| D^\beta f\|_{M_{p,Q}^\phi(\Omega)}
\end{equation}
for a constant $C_{l,n}(M)$ depending only on $l,n,M$. We will consider the same three cases that appeared with $l=0$. Since $D^\alpha Tf=D^\alpha f$ in $\Omega$, the first case is trivial as before. We will see that the cases 2 and 3 also follow from the computations done with $l=0$. We start observing that by the boundedness of $f$ and all its derivatives we can differentiate under the integral sign to get
\[D^\alpha Tf(\overline x,y)= \int_1^\infty D^\alpha g_\lambda(\overline x,y) \tau(\lambda) d\lambda\]
for every $(\overline x, y) \in \Omega^-$, where $g_\lambda(\overline x,y)=f(\overline x, y+\lambda \delta^*(\overline x, y))$. By Lemma \ref{derivatives} $D^\alpha g_\lambda(\overline x,y)$ is a finite sum of terms of the type 
\[ \widetilde c\lambda ^s D^\beta f(\overline x, y+\lambda \delta^*(\overline x, y)(D^{\gamma_1}\delta^*(x))^{n_1}\cdots (D^{\gamma_k}\delta^*(x))^{n_k}.\]
For each of these terms we also set
\[ T_{s,,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) = \int_1^\infty \lambda ^s D^\beta f(\overline x, y+\lambda \delta^*(\overline x, y)(D^{\gamma_1}\delta^*(x))^{n_1}\cdots (D^{\gamma_k}\delta^*(x))^{n_k} \tau(\lambda) d\lambda.\]
Now, since the constants $\widetilde c$ and the number of terms of the sum depend only on $l$ and $n$, we just need to estimate the quantities
\[\left( \frac{1}{\phi(r/2)}\int_Q  \left| T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x)\right|^p dx\right )^{\frac{1}{p}}.\]
We start by assuming that $|\beta|=|\alpha|.$ By the property a) in Lemma \ref{derivatives} and by the estimates of the derivatives of $\delta^*(=2a\Delta)$ given in Theorem \ref{regdist} we have that
\[ |T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) | 
\le c_2 \int_1^\infty |D^\beta f(\overline x, y+\lambda \delta^*(\overline x, y)| |\tau(\lambda)|d\lambda \]
where $c_2$ depends only on $n$ and $M.$ We are now in the same situation as in the inequality $(\bullet)$ of case $l=0$. Hence we can proceed the estimate in the same way to get 
\[\left( \frac{1}{\phi(r/2)}\int_Q  \left| T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x)\right|^p dx\right )^{\frac{1}{p}} \le c_3 \| D^\beta f \|_{M_p^\phi(\Omega)} \] 
for every $Q$ in case 2 and
\[\left( \frac{1}{\phi(r/2)}\int_{Q \cap \Omega^-}  \left| T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x)\right|^p dx\right )^{\frac{1}{p}} \le c_4 \| D^\beta f \|_{M_p^\phi(\Omega)} \] 
 for every $Q$ in case 3, where $c_3,c_4$ depend only on $n$ and $M.$
Suppose now that $|\alpha|>|\beta|.$ Arguing as above, by Theorem \ref{regdist} and Lemma \ref{derivatives} we get
\begin{align*}
&|T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) | \\
&\le c_5 \frac{1}{d(x,\overline \Omega)^{|\alpha|-|\beta|}} \left|\int_1^\infty \lambda^sD^\beta f(\overline x, y+\lambda \delta^*(\overline x, y)\tau(\lambda)d\lambda \right| \\
& \le  c_5 \frac{1}{(\psi(\overline x)-y)^{|\alpha|-|\beta|}} \left |\int_1^\infty \lambda^s D^\beta f(\overline x, y+\lambda \delta^*(\overline x, y) \tau(\lambda)d\lambda \right |\addtag \label{zzz} .   
\end{align*}
Where $c_5$ depends only on $n,l$ and $M$. We now write the Taylor expansion with integral remainder of the function $D^\beta f(\overline x, y+t)$ centered in $\delta^*(\overline x,y)$ up to order $m=|\alpha|-|\beta|$ and evaluated at $\lambda \delta^*(\overline x,y)$
\[
D^\beta f(\overline x, y+\lambda \delta^*) =\sum_{i=0}^{m-1} \frac{(\lambda \delta^*-\delta^*)^i}{i!}\frac{\partial^i D\beta f}{\partial x_n^i}(\overline x,y+\delta^*) +\int_{\delta^*}^{\lambda \delta^*} \frac{(\lambda \delta^*-t)^{m-1}}{m!}\frac{\partial^{m} D\beta f}{\partial x_n^{m} }(\overline x,y+t)dt. 
\]
We observe that the terms inside the sum doesn't give any contribution in (8), since
\begin{align*} &\int_1^\infty \frac{\lambda^s(\lambda \delta^*-\delta^*)^i}{i!}\frac{\partial^i D\beta f}{\partial x_n^i}(\overline x,y+\delta^*)\tau(\lambda)d\lambda \\
&=\frac{\partial^i D\beta f}{\partial x_n^i}(\overline x,y+\delta^*) \frac{(\delta^*)^i}{i!} \int_1^\infty \lambda^s(\lambda-1)^i\tau(\lambda)d\lambda=0
\end{align*}
by the properties of $\tau$, since $s>0$ by Lemma \ref{derivatives}. Hence combining this with \eqref{zzz} we obtain
\[|T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) | \le \frac{c_5}{(\psi(\overline x)-y)^{m}} \left |\int_1^\infty \int_{\delta^*}^{\lambda \delta^*} \frac{(\lambda \delta^*-t)^{m-1}}{m!}\frac{\partial^{m} D\beta f}{\partial x_n^{m} }(\overline x,y+t)dt \lambda^s \tau(\lambda)d\lambda\right |.\]
Observing that $(\lambda\delta^*-t)^{m-1}\le (\lambda\delta^*)^{m-1}$, recalling that $\psi(\overline x)-y\ge c \delta^*$ and using the change of variable $u=y+t$ we get
\begin{align*}
|T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) | \le \frac{c_5}{c^mm!\delta^*}\int_1^\infty \int_{y+\delta^*}^{y+\lambda \delta^*} \left|\frac{\partial^{m} D\beta f}{\partial x_n^{m} }(\overline x,u)\right |\lambda^{s+m-1} |\tau(\lambda)|du d\lambda.
\end{align*}
Perform a changing of order of integration we deduce
\[ |T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) | \le\frac{c_5}{c^mm!\delta^*}\int_{y+\delta^*}^{\infty} \left |\frac{\partial^{m} D\beta f}{\partial x_n^{m} }(\overline x,u)\right | \int_{(u-y)/\delta^*}^\infty |\lambda^{s+m-1} \tau(\lambda)| d\lambda du.\]
Finally recalling that that  $|\tau(\lambda)|\le A_{m+s}/\lambda^{s+m+3}$ for some constant $A_{m+s}$ we can write
\[ |T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x) | \le\frac{c_5 A_{m+s}}{3c^mm!} \int_{y+\delta^*}^{\infty} \left |\frac{\partial^{m} D\beta f}{\partial x_n^{m} }(\overline x,u)\right | \frac{(\delta^*)^2}{(u-y)^3} du.\]
We observe that we are now in the same situation as in the inequality $(\bullet \bullet)$ of the case $l=0$ and the same computations lead us to
\[\left( \frac{1}{\phi(r/2)}\int_Q  \left| T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x)\right|^p dx\right )^{\frac{1}{p}} \le c_6 \| \frac{\partial^{m} D\beta f}{\partial x_n^{m} } \|_{M_p^\phi(\Omega)} \] 
for every $Q$ in case 2  and
\[\left( \frac{1}{\phi(r/2)}\int_{Q\cap \Omega^-}  \left| T_{s,\beta,(\gamma_1,n_1),...,(\gamma_k,n_k)}(x)\right|^p dx\right )^{\frac{1}{p}} \le c_7 \| \frac{\partial^{m} D\beta f}{\partial x_n^{m} } \|_{M_p^\phi(\Omega)} \] 
for every $Q$ in case 3, where $c_6,c_7$ depend only on $n,l$ and $M$. This concludes also the proof of the case $l>0.$
\end{proof} 

\begin{theorem}
Let $1\le p<\infty,n\ge2$, $\phi$ a function from $\rr^+$ to $\rr^+$ and $\Omega$ be a special Lipschitz domain of $\rr^n$ with Lipschitz bound $M.$ Moreover let $S$ be the Stein extension operator. Then for every $f \in W^{l,p}(\Omega)$ and every $\alpha \in \nn_0^n$ with $|\alpha|\le l$ 
\begin{equation}
 \| D^\alpha Sf\|_{M_p^\phi(\rr^n)}\le C_{l,n}(M)\sum_{|\beta|\le |\alpha|}\|D^\beta f \|_{M_p^\phi(\Omega)} \label{Sbound}
 \end{equation}
 where $C_{l,n}(\Omega)$ depends only on $n,l$ and $M.$

 \begin{proof}
We recall definition of the operator $S.$ Set  $\Gamma$ to be the cone $\Gamma=\{(\overline x, y) \in \rr^n \ | \ M |\overline x|<|y|, y<0 \}$ and let $\eta \in C^\infty_c(\rr^n)$ be a function with total integral 1 and which support is contained in $\Gamma.$ Then, given $f \in W^{l,p}(\Omega)$, $Sf$ is defined to be the limit in $W^{l,p}(\rr^n)$ of $Tf_\varepsilon$ as $\varepsilon \to 0,$ where $f_\varepsilon(x)=1/\varepsilon^n \int_{\rr^n} f(x-y)\eta(y/\varepsilon)$ for every $x$ in an appropriate neighborhood of $	\overline \Omega$. We claim that for every $f \in W^{l,p}(\Omega)$ and $|\alpha|\le l$
\begin{equation}
\| D^\alpha_w f_\varepsilon\|_{M^\phi_p(\Omega)} \le \| D^\alpha_w f\|_{M^\phi_p(\Omega)} \label{epsbound}.
\end{equation}
To see this first we notice that $D^\alpha_w f_\varepsilon(x)=1/\varepsilon^n \int_{\rr^n} D^\alpha_w f(x-y)\eta(y/\varepsilon)dy$ for every $x \in \Omega.$ Let now $B_{x_0}(r)$ a ball centered in $\Omega$ of radius $r$, by Minkowski's integral inequality
\begin{align*}
 \left( \frac{1}{	\phi(r)} \int_{B_r(x_0)\cap \Omega} |D^\alpha f_\varepsilon (x)|^p \right)^{\frac{1}{p}} &= \left( \frac{1}{	\phi(r)} \int_{B_r(x_0)\cap \Omega} \left |\frac{1}{\varepsilon^n} \int_{\rr^n} D^\alpha_w f(x-y)\eta(\frac{y}{\varepsilon} )dy\right|^pdx \right)^{\frac{1}{p}} \\
 &\le \frac{1}{\varepsilon^n}  \int_{\rr^n} \eta(\frac{y}{\varepsilon} ) \left (\frac{1}{	\phi(r)}  \int_{B_r(x_0)\cap \Omega} |D^\alpha f(x-y)|^p dx\right)^{\frac{1}{p}}dy \\
 &\le\frac{1}{\varepsilon^n}  \int_{\rr^n} \eta(\frac{y}{\varepsilon} ) \left (\frac{1}{	\phi(r)}  \int_{B_r(x_0-y)\cap \Omega} |D^\alpha f(x)|^p dx\right)^{\frac{1}{p}}dy \\
 & \le \frac{1}{\varepsilon^n}  \int_{\rr^n} \eta(\frac{y}{\varepsilon} ) \| D^\alpha f\|_{M_p^\phi(\Omega)} dy=\| D^\alpha f\|_{M_p^\phi(\Omega)}
\end{align*}
because $B_r(x_0)\cap \Omega -y \subset B_r(x_0-y)\cap \Omega$ and $x_0-y \in \Omega$ for every $x_0 \in \Omega$ and $y \in \Gamma.$ This proves \eqref{epsbound}. Now combining \eqref{epsbound} with \eqref{Tbound2} we get 
\[ \| D^\alpha Tf_\varepsilon\|_{M_p^\phi(\rr^n)}\le C_{l,n}(M)\sum_{|\beta|\le |\alpha|}\|D^\beta f \|_{M_p^\phi(\Omega)}, \]
for every $\varepsilon>0$ and every $|\alpha|\le l$, with $C_{l,n}(M)$ independent of $\varepsilon$. In particular, for every ball $B$ in $\rr^n$ of radius $r>0$ we have
\begin{equation}
\left( \frac{1}{\phi(r)}\int_B |D^\alpha Tf_\varepsilon(x)|^p dx \right)^\frac{1}{p} \le C_{l,n}(M)\sum_{|\beta|\le |\alpha|}\|D^\beta f \|_{M_p^\phi(\Omega)} \label{balleps}
\end{equation}
Since $ Tf_\varepsilon$ converges to $Sf$ in $W^{l,p}(\rr^n)$, then  $D^\alpha Tf_\varepsilon$ converges to $D^\alpha Sf$ in $L^p(\rr^n)$ for every $|\alpha|\le l$ and as a consequence also in $L^p(B)$ for every ball $B$. Hence we can pass to the limit as $\varepsilon \to 0$ in \eqref{balleps} and obtain
\[\left( \frac{1}{\phi(r)}\int_B |D^\alpha S(x)|^p dx \right)^\frac{1}{p} \le C_{l,n}(M)\sum_{|\beta|\le |\alpha|}\|D^\beta f \|_{M_p^\phi(\Omega)} \]
for every ball $B$ of radius $\varepsilon.$ This concludes the proof.
 \end{proof} 
\end{theorem}



\bibliographystyle{plain}
\bibliography{biblio}



\end{document}